"use strict";(globalThis.webpackChunkmi_documentacion=globalThis.webpackChunkmi_documentacion||[]).push([[6655],{1496(e,n,o){o.r(n),o.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>t});const r=JSON.parse('{"id":"n8n/flujo-inventario-acumatica","title":"Flujo de Inventario HELUKABEL (Acumatica -> Excel -> Outlook)","description":"Este flujo de trabajo automatiza la extracci\xf3n de un inventario espec\xedfico desde Acumatica, procesa los datos para generar listas de precios y env\xeda el resultado por correo electr\xf3nico.","source":"@site/docs/n8n/flujo-inventario-acumatica.md","sourceDirName":"n8n","slug":"/n8n/flujo-inventario-acumatica","permalink":"/Documentacion/docs/n8n/flujo-inventario-acumatica","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/n8n/flujo-inventario-acumatica.md","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1},"sidebar":"tutorialSidebar","previous":{"title":"Introducci\xf3n a N8N","permalink":"/Documentacion/docs/n8n/intro"},"next":{"title":"Generador VCards","permalink":"/Documentacion/docs/category/generador-vcards"}}');var i=o(4848),a=o(8453);const s={sidebar_position:1},c="Flujo de Inventario HELUKABEL (Acumatica -> Excel -> Outlook)",l={},t=[{value:"Resumen del Flujo (Paso a Paso)",id:"resumen-del-flujo-paso-a-paso",level:2},{value:"Detalle de la L\xf3gica (Code Node)",id:"detalle-de-la-l\xf3gica-code-node",level:2},{value:"L\xf3gica de Negocio",id:"l\xf3gica-de-negocio",level:3},{value:"C\xf3digo Implementado",id:"c\xf3digo-implementado",level:3}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"flujo-de-inventario-helukabel-acumatica---excel---outlook",children:"Flujo de Inventario HELUKABEL (Acumatica -> Excel -> Outlook)"})}),"\n",(0,i.jsx)(n.p,{children:"Este flujo de trabajo automatiza la extracci\xf3n de un inventario espec\xedfico desde Acumatica, procesa los datos para generar listas de precios y env\xeda el resultado por correo electr\xf3nico."}),"\n",(0,i.jsx)(n.h2,{id:"resumen-del-flujo-paso-a-paso",children:"Resumen del Flujo (Paso a Paso)"}),"\n",(0,i.jsx)(n.p,{children:"El flujo se compone de 5 nodos principales, ejecut\xe1ndose de manera secuencial como se muestra en el diagrama:"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"When clicking 'Execute workflow'"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Tipo"}),": Trigger Manual."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Funci\xf3n"}),": Inicia el proceso cuando el usuario hace clic en el bot\xf3n de ejecuci\xf3n."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"HTTP Request"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Acci\xf3n"}),": Realiza una petici\xf3n ",(0,i.jsx)(n.code,{children:"GET"})," a la URL OData de Acumatica."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Objetivo"}),": Obtener la lista completa de inventarios en formato JSON."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Code in JavaScript"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Acci\xf3n"}),": Ejecuta un script personalizado."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Objetivo"}),': Filtrar los productos de la marca "HELUKABEL" y reestructurar los datos para generar m\xfaltiples registros de precios por art\xedculo.']}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Convert to File"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Acci\xf3n"}),": Convert to XLSX (Spreadsheet File)."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Objetivo"}),": Transforma el JSON procesado en un archivo binario de Excel (.xlsx) listo para ser adjuntado."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Send a message (Outlook)"}),":"]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Acci\xf3n"}),": Env\xedo de correo electr\xf3nico."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Objetivo"}),": Utiliza la conexi\xf3n con Microsoft Outlook para enviar el archivo Excel generado a los destinatarios configurados."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"detalle-de-la-l\xf3gica-code-node",children:"Detalle de la L\xf3gica (Code Node)"}),"\n",(0,i.jsxs)(n.p,{children:["El coraz\xf3n de este flujo es el nodo ",(0,i.jsx)(n.strong,{children:'"Code in JavaScript"'})," que transforma la lista cruda de Acumatica."]}),"\n",(0,i.jsx)(n.h3,{id:"l\xf3gica-de-negocio",children:"L\xf3gica de Negocio"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Filtro de Marca"}),": Solo se procesan los art\xedculos cuya propiedad ",(0,i.jsx)(n.code,{children:"Marca"}),' comienza con "HELUKABEL" (sin distinguir may\xfasculas/min\xfasculas).']}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Desglose de Precios"}),": Por cada art\xedculo encontrado, se generan 6 filas correspondientes a los siguientes c\xf3digos de precio: ",(0,i.jsx)(n.code,{children:'["FI", "IN", "CO", "UF", "DI", "CF"]'}),"."]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Mapeo de Campos"}),": Se reestructuran los datos para cumplir con el formato de carga de precios (Tipo de precio, C\xf3digo, No. de Inventario, U.M., etc.)."]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"c\xf3digo-implementado",children:"C\xf3digo Implementado"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:'// Obtener los datos del nodo anterior (Acumatica OData)\nconst items = $input.all()[0]?.json;\n\nif (items && Array.isArray(items.value)) {\n  const filteredList = [];\n  // Lista de c\xf3digos de precio a generar por cada art\xedculo\n  const priceCodes = ["FI", "IN", "CO", "UF", "DI", "CF"];\n\n  for (const row of items.value) {\n    const subBrand = row.Marca;\n    // Validar que la marca sea HELUKABEL\n    const successBrand = subBrand && typeof subBrand === \'string\' && subBrand.trim().toUpperCase().startsWith(\'HELUKABEL\');\n    \n    if (successBrand) {\n      // Por cada c\xf3digo de precio, crear una entrada\n      for (const code of priceCodes) {\n        filteredList.push({\n          json: {\n            "Tipo del precio": "Clase de precio del Cliente",\n            "Codigo del Precio": code,\n            "ID Alternativo":"",\n            "No. de Inventario": row.NodeInventario,\n            "U.M.": row.UnidadBase,\n            "Almac\xe9n":"",\n            "Cantidad de quiebre":"1.000000",\n            "Precio Origen":"",\n            "Precio Pendiente":"",\n            "Moneda":"",\n            "Marca":row.Marca\n          }\n        });\n      }\n    }\n  }\n\n  // Ordenar la lista resultante bas\xe1ndose en el orden de priceCodes\n  filteredList.sort((a, b) => {\n    return priceCodes.indexOf(a.json["Codigo del Precio"]) - priceCodes.indexOf(b.json["Codigo del Precio"]);\n  });\n\n  return filteredList;\n}\n\nreturn [];\n'})})]})}function u(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,o){o.d(n,{R:()=>s,x:()=>c});var r=o(6540);const i={},a=r.createContext(i);function s(e){const n=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(a.Provider,{value:n},e.children)}}}]);